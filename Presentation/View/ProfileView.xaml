<UserControl x:Class="Presentation.Views.ProfileView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="clr-namespace:Presentation.ViewModels"
             mc:Ignorable="d"
             d:DesignHeight="800" d:DesignWidth="1200"
             
             Background="#1C1C1C">

  <UserControl.Resources>
    <Style TargetType="TextBlock">
      <Setter Property="Foreground" Value="#E0E0E0"/>
    </Style>

    <Style x:Key="ProfileButtonStyle" TargetType="{x:Type Button}">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="#CCCCCC"/>
      <Setter Property="Padding" Value="10"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="HorizontalAlignment" Value="Stretch"/>
      <Setter Property="HorizontalContentAlignment" Value="Left"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="FontSize" Value="16"/>
      <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="Background" Value="#351010"/>
          <Setter Property="Foreground" Value="#FF3030"/>
        </Trigger>
      </Style.Triggers>
    </Style>

    <Style x:Key="LogoutButtonStyle" TargetType="{x:Type Button}">
      <Setter Property="Background" Value="#FF3030"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="Padding" Value="12"/>
      <Setter Property="FontSize" Value="16"/>
      <Setter Property="FontWeight" Value="Bold"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Border Background="{TemplateBinding Background}" CornerRadius="8">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#AA1010"/>
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

  </UserControl.Resources>

  <Grid Margin="30">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <TextBlock Grid.Row="0" Text="ПРОФІЛЬ КОРИСТУВАЧА"
               FontSize="36" FontWeight="ExtraBold"
               Margin="0,0,0,25"
               Foreground="#FF3030"/>

    <Grid Grid.Row="1">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="320"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <Border Grid.Column="0"
              Background="#101010" BorderBrush="#333333"
              BorderThickness="1"
              CornerRadius="10"
              Padding="25"
              Margin="0,0,30,0">
        <StackPanel>

          <Ellipse Width="90" Height="90"
                   Fill="#FF3030" Stroke="White"
                   StrokeThickness="2"
                   Margin="0,0,0,20"/>

          <TextBlock Text="{Binding CurrentUser.Username}"
                     FontSize="28" FontWeight="Bold"
                     HorizontalAlignment="Center"
                     Margin="0,0,0,5"
                     Foreground="White"/>

          <TextBlock Text="{Binding CurrentUser.Email}"
                     FontSize="14"
                     Foreground="#AAAAAA"
                     HorizontalAlignment="Center"
                     Margin="0,0,0,30"/>

          <TextBlock Text="Налаштування"
                     FontSize="20" FontWeight="SemiBold"
                     Foreground="#FF3030" Margin="0,40,0,10"/>

          <Button Content="Змінити пароль" Command="{Binding ChangePasswordCommand}" Style="{StaticResource ProfileButtonStyle}" Margin="0,5"/>
          <Button Content="Керування даними" Command="{Binding ManageDataCommand}" Style="{StaticResource ProfileButtonStyle}" Margin="0,5"/>
          <Button Content="Історія покупок" Style="{StaticResource ProfileButtonStyle}" Margin="0,5"/>

          <Separator Margin="0,20" Background="#333333"/>

          <Button Content="Вийти з профілю"
                  Command="{Binding LogoutCommand}"
                  Style="{StaticResource LogoutButtonStyle}"
                  HorizontalAlignment="Stretch"
                  Margin="0,0,0,0"/>

        </StackPanel>
      </Border>

      <Grid Grid.Column="1">
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Моя Бібліотека Ігор"
                   FontSize="24" FontWeight="SemiBold"
                   Foreground="White"
                   Margin="5,0,0,15"/>

        <Border Grid.Row="1"
                Background="#101010" CornerRadius="10"
                Padding="15"
                BorderBrush="#333333"
                BorderThickness="1">
          <Border.Effect>
            <DropShadowEffect Color="Black" Opacity="0.3" Direction="270" ShadowDepth="3" BlurRadius="5"/>
          </Border.Effect>

          <ListView ItemsSource="{Binding UserGames}"
                    Background="Transparent"
                    BorderThickness="0"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    Style="{x:Null}">

            <ListView.ItemContainerStyle>
              <Style TargetType="ListViewItem">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Margin" Value="0, 5, 0, 5"/>
                <Setter Property="Template">
                  <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListViewItem}">
                      <ContentPresenter/>
                    </ControlTemplate>
                  </Setter.Value>
                </Setter>
              </Style>
            </ListView.ItemContainerStyle>

            <ListView.ItemTemplate>
              <DataTemplate>
                <Grid Height="60" Cursor="Hand">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="60"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                  </Grid.ColumnDefinitions>

                  <Border Grid.Column="0"
        Width="40" Height="55"
        Background="#252525"
        BorderBrush="#333333"
        BorderThickness="0"
        CornerRadius="3"
        Margin="0,0,15,0"
        VerticalAlignment="Center">
                    <Grid>
                      <Image Source="{Binding ImageSource}"
                             Stretch="UniformToFill"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center">
                        <Image.Style>
                          <Style TargetType="Image">
                            <Setter Property="Visibility" Value="Visible"/>
                            <Style.Triggers>
                              <DataTrigger Binding="{Binding ImageSource}" Value="">
                                <Setter Property="Visibility" Value="Collapsed"/>
                              </DataTrigger>
                              <DataTrigger Binding="{Binding ImageSource}" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                              </DataTrigger>
                            </Style.Triggers>
                          </Style>
                        </Image.Style>
                      </Image>

                      <TextBlock Text="🎮"
                                 FontSize="20"
                                 VerticalAlignment="Center"
                                 HorizontalAlignment="Center"
                                 Foreground="#888888">
                        <TextBlock.Style>
                          <Style TargetType="TextBlock">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                              <DataTrigger Binding="{Binding ImageSource}" Value="">
                                <Setter Property="Visibility" Value="Visible"/>
                              </DataTrigger>
                              <DataTrigger Binding="{Binding ImageSource}" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Visible"/>
                              </DataTrigger>
                            </Style.Triggers>
                          </Style>
                        </TextBlock.Style>
                      </TextBlock>
                    </Grid>
                  </Border>

                  <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <TextBlock Text="{Binding Title}"
                               FontSize="18" FontWeight="SemiBold"
                               Foreground="White"/>
                    <TextBlock Text="{Binding HoursPlayed, StringFormat='Час гри: {0} год'}"
                               FontSize="12" Foreground="#AAAAAA"/>
                  </StackPanel>

                  <Button Grid.Column="2" Content="ГРАТИ"
                          Background="#FF3030" Foreground="White"
                          Padding="10, 5" Width="80" Height="35"
                          Command="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.LaunchGameCommand}"
                          CommandParameter="{Binding}"/>
                </Grid>
              </DataTemplate>
            </ListView.ItemTemplate>

          </ListView>

        </Border>
      </Grid>
    </Grid>
  </Grid>
</UserControl>