<UserControl x:Class="Presentation.Views.MainPageView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:Presentation.ViewModels"
             mc:Ignorable="d"
             d:DesignHeight="800" d:DesignWidth="1200"
             
             Background="#1C1C1C"
             d:DataContext="{d:DesignInstance vm:MainPageViewModel}">

	<UserControl.Resources>

		<Style TargetType="TextBlock">
			<Setter Property="Foreground" Value="#E0E0E0"/>
		</Style>

		<Style TargetType="TextBox">
			<Setter Property="Background" Value="#252525"/>
			<Setter Property="Foreground" Value="#E0E0E0"/>
			<Setter Property="BorderBrush" Value="#444444"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Padding" Value="5,0"/>
			<Setter Property="CaretBrush" Value="#FF3030"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
		</Style>

		<!-- ✅ СТИЛЬ З АНІМАЦІЄЮ ДЛЯ КАРТОК ІГОР -->
		<Style x:Key="GameCardButtonStyle" TargetType="Button">
			<Setter Property="Background" Value="#101010"/>
			<Setter Property="BorderBrush" Value="#333333"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Padding" Value="0"/>
			<Setter Property="Margin" Value="10"/>
			<Setter Property="Width" Value="200"/>
			<Setter Property="Height" Value="280"/>
			<Setter Property="Cursor" Value="Hand"/>
			<Setter Property="RenderTransform">
				<Setter.Value>
					<TransformGroup>
						<ScaleTransform ScaleX="0.8" ScaleY="0.8"/>
						<TranslateTransform Y="20"/>
					</TransformGroup>
				</Setter.Value>
			</Setter>
			<Setter Property="Opacity" Value="0"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8"
                                RenderTransform="{TemplateBinding RenderTransform}"
                                RenderTransformOrigin="0.5,0.5">
							<ContentPresenter HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="border" Property="BorderBrush" Value="#FF3030"/>
								<Setter TargetName="border" Property="Effect">
									<Setter.Value>
										<DropShadowEffect Color="#FF3030" Opacity="0.5" ShadowDepth="0" BlurRadius="10"/>
									</Setter.Value>
								</Setter>
								<Trigger.EnterActions>
									<BeginStoryboard>
										<Storyboard>
											<DoubleAnimation Storyboard.TargetName="border"
                                                             Storyboard.TargetProperty="(RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)"
                                                             To="1.05"
                                                             Duration="0:0:0.2">
												<DoubleAnimation.EasingFunction>
													<CubicEase EasingMode="EaseOut"/>
												</DoubleAnimation.EasingFunction>
											</DoubleAnimation>
											<DoubleAnimation Storyboard.TargetName="border"
                                                             Storyboard.TargetProperty="(RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)"
                                                             To="1.05"
                                                             Duration="0:0:0.2">
												<DoubleAnimation.EasingFunction>
													<CubicEase EasingMode="EaseOut"/>
												</DoubleAnimation.EasingFunction>
											</DoubleAnimation>
										</Storyboard>
									</BeginStoryboard>
								</Trigger.EnterActions>
								<Trigger.ExitActions>
									<BeginStoryboard>
										<Storyboard>
											<DoubleAnimation Storyboard.TargetName="border"
                                                             Storyboard.TargetProperty="(RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)"
                                                             To="1"
                                                             Duration="0:0:0.2">
												<DoubleAnimation.EasingFunction>
													<CubicEase EasingMode="EaseOut"/>
												</DoubleAnimation.EasingFunction>
											</DoubleAnimation>
											<DoubleAnimation Storyboard.TargetName="border"
                                                             Storyboard.TargetProperty="(RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)"
                                                             To="1"
                                                             Duration="0:0:0.2">
												<DoubleAnimation.EasingFunction>
													<CubicEase EasingMode="EaseOut"/>
												</DoubleAnimation.EasingFunction>
											</DoubleAnimation>
										</Storyboard>
									</BeginStoryboard>
								</Trigger.ExitActions>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<!-- ✅ АНІМАЦІЯ ПОЯВИ ПРИ ЗАВАНТАЖЕННІ -->
			<Style.Triggers>
				<EventTrigger RoutedEvent="Loaded">
					<BeginStoryboard>
						<Storyboard>
							<!-- Плавна поява з прозорості -->
							<DoubleAnimation Storyboard.TargetProperty="Opacity"
                                             From="0" To="1"
                                             Duration="0:0:0.6">
								<DoubleAnimation.EasingFunction>
									<CubicEase EasingMode="EaseOut"/>
								</DoubleAnimation.EasingFunction>
							</DoubleAnimation>

							<!-- Масштабування від 0.8 до 1 -->
							<DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)"
                                             From="0.8" To="1"
                                             Duration="0:0:0.6">
								<DoubleAnimation.EasingFunction>
									<BackEase EasingMode="EaseOut" Amplitude="0.3"/>
								</DoubleAnimation.EasingFunction>
							</DoubleAnimation>

							<DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)"
                                             From="0.8" To="1"
                                             Duration="0:0:0.6">
								<DoubleAnimation.EasingFunction>
									<BackEase EasingMode="EaseOut" Amplitude="0.3"/>
								</DoubleAnimation.EasingFunction>
							</DoubleAnimation>

							<!-- Рух знизу вгору -->
							<DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(TransformGroup.Children)[1].(TranslateTransform.Y)"
                                             From="20" To="0"
                                             Duration="0:0:0.6">
								<DoubleAnimation.EasingFunction>
									<CubicEase EasingMode="EaseOut"/>
								</DoubleAnimation.EasingFunction>
							</DoubleAnimation>
						</Storyboard>
					</BeginStoryboard>
				</EventTrigger>
			</Style.Triggers>
		</Style>

		<!-- ✅ СТИЛЬ З ЗАТРИМКОЮ ДЛЯ ЕФЕКТУ "ХВИЛІ" -->
		<Style x:Key="GameCardButtonAnimatedStyle" TargetType="Button" BasedOn="{StaticResource GameCardButtonStyle}">
			<Style.Triggers>
				<EventTrigger RoutedEvent="Loaded">
					<BeginStoryboard>
						<Storyboard>
							<DoubleAnimation Storyboard.TargetProperty="Opacity"
                                             From="0" To="1"
                                             BeginTime="0:0:0.05"
                                             Duration="0:0:0.6">
								<DoubleAnimation.EasingFunction>
									<CubicEase EasingMode="EaseOut"/>
								</DoubleAnimation.EasingFunction>
							</DoubleAnimation>

							<DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)"
                                             From="0.8" To="1"
                                             BeginTime="0:0:0.05"
                                             Duration="0:0:0.6">
								<DoubleAnimation.EasingFunction>
									<BackEase EasingMode="EaseOut" Amplitude="0.3"/>
								</DoubleAnimation.EasingFunction>
							</DoubleAnimation>

							<DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)"
                                             From="0.8" To="1"
                                             BeginTime="0:0:0.05"
                                             Duration="0:0:0.6">
								<DoubleAnimation.EasingFunction>
									<BackEase EasingMode="EaseOut" Amplitude="0.3"/>
								</DoubleAnimation.EasingFunction>
							</DoubleAnimation>

							<DoubleAnimation Storyboard.TargetProperty="(RenderTransform).(TransformGroup.Children)[1].(TranslateTransform.Y)"
                                             From="20" To="0"
                                             BeginTime="0:0:0.05"
                                             Duration="0:0:0.6">
								<DoubleAnimation.EasingFunction>
									<CubicEase EasingMode="EaseOut"/>
								</DoubleAnimation.EasingFunction>
							</DoubleAnimation>
						</Storyboard>
					</BeginStoryboard>
				</EventTrigger>
			</Style.Triggers>
		</Style>

	</UserControl.Resources>

	<Grid Margin="20">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<!-- ЗАГОЛОВОК ТА ПОШУК -->
		<Grid Grid.Row="0" Margin="0,0,0,20">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*"/>
				<ColumnDefinition Width="Auto"/>
			</Grid.ColumnDefinitions>

			<TextBlock Grid.Column="0"
                       Text="GAME LIBRARY"
                       FontSize="30"
                       FontWeight="ExtraBold"
                       Foreground="#E0E0E0"
                       VerticalAlignment="Center"/>

			<DockPanel Grid.Column="1" VerticalAlignment="Center" Margin="10,0">
				<TextBox Width="250"
                         Text="{Binding SearchTerm, UpdateSourceTrigger=PropertyChanged}"
                         VerticalContentAlignment="Center"
                         Margin="0,0,5,0"
                         Height="35"/>

				<Button Content="🔍"
                        Width="35"
                        Height="35"
                        Background="#FF3030"
                        Foreground="White"
                        FontWeight="Bold"
                        FontSize="16"/>
			</DockPanel>
		</Grid>

		<!-- ОСНОВНИЙ КОНТЕНТ -->
		<Grid Grid.Row="1">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="220"/>
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>

			<!-- ФІЛЬТРИ -->
			<StackPanel Grid.Column="0" Margin="0,0,25,0">
				<TextBlock Text="FILTERS"
                           FontSize="20"
                           FontWeight="Bold"
                           Foreground="#FF3030"
                           Margin="0,0,0,10"/>

				<Border BorderBrush="#333333"
                        BorderThickness="1"
                        Background="#101010"
                        CornerRadius="5"
                        Padding="15"
                        Height="200">
					<TextBlock Text="Filter options go here (Genre, Platform, Price, etc.)"
                               Foreground="#888888"
                               TextWrapping="Wrap"/>
				</Border>
			</StackPanel>

			<!-- СПИСОК ІГОР З АНІМАЦІЄЮ -->
			<ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
				<ItemsControl x:Name="GameItemsControl" ItemsSource="{Binding Games}">
					<ItemsControl.ItemsPanel>
						<ItemsPanelTemplate>
							<WrapPanel Orientation="Horizontal" HorizontalAlignment="Stretch" Margin="0, 0, 0, 10"/>
						</ItemsPanelTemplate>
					</ItemsControl.ItemsPanel>

					<ItemsControl.ItemTemplate>
						<DataTemplate>
							<!-- ✅ ВИКОРИСТОВУЄМО АНІМОВАНИЙ СТИЛЬ -->
							<Button Style="{StaticResource GameCardButtonAnimatedStyle}"
                                    Command="{Binding DataContext.GoToGameDetailsCommand, 
                                                     RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                    CommandParameter="{Binding}">

								<Grid>
									<Grid.RowDefinitions>
										<RowDefinition Height="*"/>
										<RowDefinition Height="Auto"/>
									</Grid.RowDefinitions>

									<!-- ЗОБРАЖЕННЯ ГРИ -->
									<Border Grid.Row="0" Background="#252525" CornerRadius="8,8,0,0">
										<Grid>
											<Image Source="{Binding ImageSource}"
                                                   Stretch="UniformToFill"
                                                   VerticalAlignment="Center"
                                                   HorizontalAlignment="Center">
												<Image.Style>
													<Style TargetType="Image">
														<Setter Property="Visibility" Value="Visible"/>
														<Style.Triggers>
															<DataTrigger Binding="{Binding ImageSource}" Value="">
																<Setter Property="Visibility" Value="Collapsed"/>
															</DataTrigger>
														</Style.Triggers>
													</Style>
												</Image.Style>
											</Image>

											<TextBlock Text="🎮"
                                                       FontSize="48"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Foreground="#888888">
												<TextBlock.Style>
													<Style TargetType="TextBlock">
														<Setter Property="Visibility" Value="Collapsed"/>
														<Style.Triggers>
															<DataTrigger Binding="{Binding ImageSource}" Value="">
																<Setter Property="Visibility" Value="Visible"/>
															</DataTrigger>
														</Style.Triggers>
													</Style>
												</TextBlock.Style>
											</TextBlock>
										</Grid>
									</Border>

									<!-- ІНФОРМАЦІЯ ПРО ГРУ -->
									<Grid Grid.Row="1" Margin="10" VerticalAlignment="Center">
										<Grid.RowDefinitions>
											<RowDefinition Height="Auto"/>
											<RowDefinition Height="Auto"/>
										</Grid.RowDefinitions>

										<TextBlock Grid.Row="0"
                                                   Text="{Binding Title}"
                                                   FontWeight="SemiBold"
                                                   FontSize="14"
                                                   TextWrapping="Wrap"
                                                   VerticalAlignment="Center"
                                                   Foreground="White"
                                                   Margin="0,0,0,5"/>

										<TextBlock Grid.Row="1"
                                                   FontWeight="Bold"
                                                   Foreground="#FF3030"
                                                   FontSize="16"
                                                   HorizontalAlignment="Center">
											<TextBlock.Style>
												<Style TargetType="TextBlock">
													<Setter Property="Text" Value="{Binding Price, StringFormat={}{0:C2}}"/>
													<Style.Triggers>
														<DataTrigger Binding="{Binding Price}" Value="0">
															<Setter Property="Text" Value="FREE"/>
															<Setter Property="Foreground" Value="#10AA10"/>
														</DataTrigger>
													</Style.Triggers>
												</Style>
											</TextBlock.Style>
										</TextBlock>
									</Grid>
								</Grid>
							</Button>
						</DataTemplate>
					</ItemsControl.ItemTemplate>
				</ItemsControl>
			</ScrollViewer>
		</Grid>
	</Grid>
</UserControl>